#!/usr/bin/env node
const _0x4298eb=_0x5c63;(function(_0x2169bf,_0x12154c){const _0x546e44=_0x5c63,_0x4d8e80=_0x2169bf();while(!![]){try{const _0x24b105=-parseInt(_0x546e44(0x12b))/0x1*(-parseInt(_0x546e44(0x111))/0x2)+-parseInt(_0x546e44(0x10b))/0x3*(parseInt(_0x546e44(0x113))/0x4)+parseInt(_0x546e44(0x100))/0x5+-parseInt(_0x546e44(0x11c))/0x6*(parseInt(_0x546e44(0x10d))/0x7)+parseInt(_0x546e44(0x128))/0x8*(-parseInt(_0x546e44(0x138))/0x9)+parseInt(_0x546e44(0x11d))/0xa*(parseInt(_0x546e44(0x117))/0xb)+-parseInt(_0x546e44(0xfd))/0xc*(parseInt(_0x546e44(0x118))/0xd);if(_0x24b105===_0x12154c)break;else _0x4d8e80['push'](_0x4d8e80['shift']());}catch(_0x295ea6){_0x4d8e80['push'](_0x4d8e80['shift']());}}}(_0x3331,0x5b9cc));const _0x472aef=(function(){let _0x48e3ee=!![];return function(_0x3b812f,_0x1fb5e1){const _0x37ac10=_0x48e3ee?function(){const _0x3517c0=_0x5c63;if(_0x1fb5e1){const _0x3afdcc=_0x1fb5e1[_0x3517c0(0x11e)](_0x3b812f,arguments);return _0x1fb5e1=null,_0x3afdcc;}}:function(){};return _0x48e3ee=![],_0x37ac10;};}()),_0x5d0679=_0x472aef(this,function(){const _0x5d2979=_0x5c63,_0x33f02b={};_0x33f02b['NKHQl']=_0x5d2979(0x132);const _0x3ba1fa=_0x33f02b;return _0x5d0679[_0x5d2979(0x108)]()[_0x5d2979(0x123)](_0x3ba1fa['NKHQl'])[_0x5d2979(0x108)]()[_0x5d2979(0x11f)](_0x5d0679)[_0x5d2979(0x123)](_0x5d2979(0x132));});_0x5d0679();var m=(_0x32ac62=>typeof require<'u'?require:typeof Proxy<'u'?new Proxy(_0x32ac62,{'get':(_0x562b44,_0x6dc54b)=>(typeof require<'u'?require:_0x562b44)[_0x6dc54b]}):_0x32ac62)(function(_0x45432f){const _0x1a1e32=_0x5c63,_0x209f1d={'iIHbY':function(_0x46c9cb,_0x175293){return _0x46c9cb(_0x175293);},'RnUkR':function(_0x360959,_0x2d4561){return _0x360959+_0x2d4561;}};if(typeof require<'u')return require[_0x1a1e32(0x11e)](this,arguments);throw _0x209f1d['iIHbY'](Error,_0x209f1d[_0x1a1e32(0x116)](_0x1a1e32(0x10c)+_0x45432f,_0x1a1e32(0x11a)));}),l=m('fs'),f=m(_0x4298eb(0x129)),d=process[_0x4298eb(0x101)][0x2]||'{}',u;function _0x3331(){const _0x2b3c3e=['ADD\x20COLUMN\x20without\x20DEFAULT\x20or\x20NULLABLE\x20-\x20may\x20fail\x20on\x20existing\x20data','Migration\x20contains\x20debug\x20statements\x20(console.log/print)','BLOCKED:\x20Direct\x20database\x20schema\x20file\x20modification\x20is\x20forbidden','push','Remove\x20debug\x20code\x20before\x20committing','(((.+)+)+)+$','Database\x20schema\x20changes\x20MUST\x20be\x20in\x20migration\x20files,\x20not\x20in\x20application\x20code','warn','WARNING:\x20ORM\x20model/entity\x20definitions\x20detected','\x0aMIGRATION\x20WARNINGS:','Database\x20changes\x20MUST\x20be\x20done\x20through\x20migration\x20scripts','9AQDhRG','\x20detected\x20-\x20this\x20causes\x20data\x20loss!','43716eMsbYP','\x20\x20-\x20TypeORM:\x20npm\x20run\x20migration:generate\x20--\x20-n\x20YourChange','some','2935620zuMlkq','argv','When\x20changing\x20models,\x20create\x20a\x20migration\x20to\x20update\x20the\x20database','Create\x20a\x20new\x20migration\x20to\x20make\x20additional\x20changes','DROP\x20TABLE\x20without\x20IF\x20EXISTS\x20-\x20migration\x20may\x20fail\x20on\x20retry','\x20\x20-\x20Django:\x20python\x20manage.py\x20makemigrations','test','Ensure\x20you\x20have\x20a\x20backup\x20before\x20running\x20this\x20migration','toString','Edit','DANGER:\x20','69FXSmPy','Dynamic\x20require\x20of\x20\x22','402899FVpnef','forEach','basename','Did\x20you\x20create\x20a\x20migration\x20for\x20these\x20changes?','18MKtqqK','\x0aDatabase\x20changes\x20must\x20follow\x20migration\x20workflow.\x0a','53216MMzYtP','BLOCKED:\x20Direct\x20DDL\x20(Data\x20Definition\x20Language)\x20detected\x20in\x20code','tool_input','RnUkR','8090522Rorkgj','936NHWEaJ','source','\x22\x20is\x20not\x20supported','BLOCKED:\x20Cannot\x20modify\x20existing\x20migration\x20file','78TPUlcm','10aCLkUu','apply','constructor','length','utf8','match','search','\x0aMIGRATION\x20VALIDATION\x20FAILED:','file_path','error','exit','1260408ETJWqc','path','readFileSync','58522uiPzZf','File:\x20'];_0x3331=function(){return _0x2b3c3e;};return _0x3331();}try{u=JSON['parse'](d);}catch{process['exit'](0x0);}var a=u[_0x4298eb(0x115)]?.[_0x4298eb(0x125)];a||process['exit'](0x0);var t=[],n=[],r=f[_0x4298eb(0x10f)](a),D=[/schema\.sql$/i,/database\.sql$/i,/db\.sql$/i,/init\.sql$/i,/^schema\.(ts|js|py)$/i,/models\.py$/i,/entity\.(ts|js)$/i],p=a[_0x4298eb(0x122)](/migrations?\/|migrate\//i),E=D[_0x4298eb(0xff)](_0x330fd1=>_0x330fd1[_0x4298eb(0x106)](r));function _0x5c63(_0x8580f3,_0x5b938e){_0x8580f3=_0x8580f3-0xfc;const _0x24c89f=_0x3331();let _0x5d0679=_0x24c89f[_0x8580f3];return _0x5d0679;}E&&!p&&(t[_0x4298eb(0x130)](_0x4298eb(0x12f)),t['push'](_0x4298eb(0x12c)+r),t[_0x4298eb(0x130)](_0x4298eb(0x137)),t[_0x4298eb(0x130)]('Create\x20a\x20migration\x20instead:'),t['push']('\x20\x20-\x20Sequelize:\x20npx\x20sequelize-cli\x20migration:generate\x20--name\x20your-change'),t[_0x4298eb(0x130)](_0x4298eb(0xfe)),t[_0x4298eb(0x130)](_0x4298eb(0x105)),t[_0x4298eb(0x130)]('\x20\x20-\x20Prisma:\x20npx\x20prisma\x20migrate\x20dev\x20--name\x20your-change'),t[_0x4298eb(0x130)]('\x20\x20-\x20Knex:\x20npx\x20knex\x20migrate:make\x20your_change'));if(!p&&a['match'](/\.(ts|js|py|sql)$/)){let e;try{e=l[_0x4298eb(0x12a)](a,_0x4298eb(0x121));}catch{process[_0x4298eb(0x127)](0x0);}let i=[/ALTER\s+TABLE/gi,/DROP\s+TABLE/gi,/DROP\s+COLUMN/gi,/CREATE\s+TABLE/gi,/ADD\s+COLUMN/gi,/RENAME\s+TABLE/gi,/RENAME\s+COLUMN/gi,/CREATE\s+INDEX/gi,/DROP\s+INDEX/gi];for(let o of i)o[_0x4298eb(0x106)](e)&&(t[_0x4298eb(0x130)](_0x4298eb(0x114)),t[_0x4298eb(0x130)]('File:\x20'+r),t[_0x4298eb(0x130)]('Pattern:\x20'+o[_0x4298eb(0x119)]),t[_0x4298eb(0x130)](_0x4298eb(0x133)),t[_0x4298eb(0x130)]('Create\x20a\x20proper\x20migration\x20script\x20instead'));let s=[/@Column\(/gi,/db\.Column\(/gi,/models\.CharField/gi,/type:\s*Sequelize\./gi],c=0x0;for(let o of s){let h=e[_0x4298eb(0x122)](o);h&&(c+=h[_0x4298eb(0x120)]);}c>0x0&&!a['includes']('test')&&(n['push'](_0x4298eb(0x135)),n[_0x4298eb(0x130)]('File:\x20'+r),n[_0x4298eb(0x130)](_0x4298eb(0x102)),n[_0x4298eb(0x130)](_0x4298eb(0x110)));}if(p&&a['match'](/\.(ts|js|py|sql)$/)){let e;try{e=l[_0x4298eb(0x12a)](a,_0x4298eb(0x121));}catch{process[_0x4298eb(0x127)](0x0);}let i=[],s=[],c=e['match'](/\bup\s*[:=\(]|def\s+upgrade\s*\(|function\s+up\s*\(/i),o=e[_0x4298eb(0x122)](/\bdown\s*[:=\(]|def\s+downgrade\s*\(|function\s+down\s*\(/i);c||i[_0x4298eb(0x130)]('Migration\x20missing\x20UP/UPGRADE\x20function'),o||s['push']('Migration\x20missing\x20DOWN/DOWNGRADE\x20function\x20(rollback\x20will\x20fail)'),e[_0x4298eb(0x122)](/DROP\s+TABLE/gi)&&(e['match'](/IF\s+EXISTS/gi)||s[_0x4298eb(0x130)](_0x4298eb(0x104))),e['match'](/ADD\s+COLUMN/gi)&&(e[_0x4298eb(0x122)](/DEFAULT|NULLABLE/gi)||s[_0x4298eb(0x130)](_0x4298eb(0x12d)));let h=[/DROP\s+COLUMN/gi,/DROP\s+TABLE/gi,/TRUNCATE/gi,/DELETE\s+FROM/gi];for(let g of h)g['test'](e)&&(s[_0x4298eb(0x130)](_0x4298eb(0x10a)+g[_0x4298eb(0x119)]+_0x4298eb(0xfc)),s[_0x4298eb(0x130)](_0x4298eb(0x107)));r[_0x4298eb(0x122)](/(\d{10,14})/)&&u['tool']===_0x4298eb(0x109)&&(i[_0x4298eb(0x130)](_0x4298eb(0x11b)),i[_0x4298eb(0x130)]('Migrations\x20should\x20be\x20immutable\x20once\x20created'),i[_0x4298eb(0x130)](_0x4298eb(0x103))),e[_0x4298eb(0x122)](/console\.log|print\(/)&&(s['push'](_0x4298eb(0x12e)),s[_0x4298eb(0x130)](_0x4298eb(0x131))),i['length']>0x0&&(t['push'](_0x4298eb(0x124)),t[_0x4298eb(0x130)](...i)),s['length']>0x0&&(n[_0x4298eb(0x130)](_0x4298eb(0x136)),n[_0x4298eb(0x130)](...s));}t[_0x4298eb(0x120)]>0x0&&(console['error']('\x0a❌\x20DATABASE\x20CHANGE\x20VALIDATION\x20FAILED\x0a'),t['forEach'](_0x2cef6d=>console[_0x4298eb(0x126)]('\x20\x20'+_0x2cef6d)),console[_0x4298eb(0x126)](_0x4298eb(0x112)),process[_0x4298eb(0x127)](0x2)),n['length']>0x0&&(console[_0x4298eb(0x134)]('\x0a⚠️\x20\x20DATABASE\x20CHANGE\x20WARNINGS\x0a'),n[_0x4298eb(0x10e)](_0x1725c9=>console[_0x4298eb(0x134)]('\x20\x20'+_0x1725c9)),console['warn']('\x0a')),process[_0x4298eb(0x127)](0x0);